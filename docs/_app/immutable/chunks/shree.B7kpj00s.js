function be(X,se){for(var H=0;H<se.length;H++){const q=se[H];if(typeof q!="string"&&!Array.isArray(q)){for(const w in q)if(w!=="default"&&!(w in X)){const y=Object.getOwnPropertyDescriptor(q,w);y&&Object.defineProperty(X,w,y.get?y:{enumerable:!0,get:()=>q[w]})}}}return Object.freeze(Object.defineProperty(X,Symbol.toStringTag,{value:"Module"}))}function ge(X){return X&&X.__esModule&&Object.prototype.hasOwnProperty.call(X,"default")?X.default:X}var _e={exports:{}};(function(X,se){(function(H,q){X.exports=q()})(window,function(){return function(H){var q={};function w(y){if(q[y])return q[y].exports;var p=q[y]={i:y,l:!1,exports:{}};return H[y].call(p.exports,p,p.exports,w),p.l=!0,p.exports}return w.m=H,w.c=q,w.d=function(y,p,V){w.o(y,p)||Object.defineProperty(y,p,{enumerable:!0,get:V})},w.r=function(y){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})},w.t=function(y,p){if(1&p&&(y=w(y)),8&p||4&p&&typeof y=="object"&&y&&y.__esModule)return y;var V=Object.create(null);if(w.r(V),Object.defineProperty(V,"default",{enumerable:!0,value:y}),2&p&&typeof y!="string")for(var Z in y)w.d(V,Z,(function(Q){return y[Q]}).bind(null,Z));return V},w.n=function(y){var p=y&&y.__esModule?function(){return y.default}:function(){return y};return w.d(p,"a",p),p},w.o=function(y,p){return Object.prototype.hasOwnProperty.call(y,p)},w.p="",w(w.s=1)}([function(H,q,w){var y=Object.prototype.hasOwnProperty,p="~";function V(){}function Z(d,m,v){this.fn=d,this.context=m,this.once=v||!1}function Q(d,m,v,G,W){if(typeof v!="function")throw new TypeError("The listener must be a function");var U=new Z(v,G||d,W),Y=p?p+m:m;return d._events[Y]?d._events[Y].fn?d._events[Y]=[d._events[Y],U]:d._events[Y].push(U):(d._events[Y]=U,d._eventsCount++),d}function $(d,m){--d._eventsCount==0?d._events=new V:delete d._events[m]}function k(){this._events=new V,this._eventsCount=0}Object.create&&(V.prototype=Object.create(null),new V().__proto__||(p=!1)),k.prototype.eventNames=function(){var d,m,v=[];if(this._eventsCount===0)return v;for(m in d=this._events)y.call(d,m)&&v.push(p?m.slice(1):m);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(d)):v},k.prototype.listeners=function(d){var m=p?p+d:d,v=this._events[m];if(!v)return[];if(v.fn)return[v.fn];for(var G=0,W=v.length,U=new Array(W);G<W;G++)U[G]=v[G].fn;return U},k.prototype.listenerCount=function(d){var m=p?p+d:d,v=this._events[m];return v?v.fn?1:v.length:0},k.prototype.emit=function(d,m,v,G,W,U){var Y=p?p+d:d;if(!this._events[Y])return!1;var z,L,O=this._events[Y],J=arguments.length;if(O.fn){switch(O.once&&this.removeListener(d,O.fn,void 0,!0),J){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,m),!0;case 3:return O.fn.call(O.context,m,v),!0;case 4:return O.fn.call(O.context,m,v,G),!0;case 5:return O.fn.call(O.context,m,v,G,W),!0;case 6:return O.fn.call(O.context,m,v,G,W,U),!0}for(L=1,z=new Array(J-1);L<J;L++)z[L-1]=arguments[L];O.fn.apply(O.context,z)}else{var K,le=O.length;for(L=0;L<le;L++)switch(O[L].once&&this.removeListener(d,O[L].fn,void 0,!0),J){case 1:O[L].fn.call(O[L].context);break;case 2:O[L].fn.call(O[L].context,m);break;case 3:O[L].fn.call(O[L].context,m,v);break;case 4:O[L].fn.call(O[L].context,m,v,G);break;default:if(!z)for(K=1,z=new Array(J-1);K<J;K++)z[K-1]=arguments[K];O[L].fn.apply(O[L].context,z)}}return!0},k.prototype.on=function(d,m,v){return Q(this,d,m,v,!1)},k.prototype.once=function(d,m,v){return Q(this,d,m,v,!0)},k.prototype.removeListener=function(d,m,v,G){var W=p?p+d:d;if(!this._events[W])return this;if(!m)return $(this,W),this;var U=this._events[W];if(U.fn)U.fn!==m||G&&!U.once||v&&U.context!==v||$(this,W);else{for(var Y=0,z=[],L=U.length;Y<L;Y++)(U[Y].fn!==m||G&&!U[Y].once||v&&U[Y].context!==v)&&z.push(U[Y]);z.length?this._events[W]=z.length===1?z[0]:z:$(this,W)}return this},k.prototype.removeAllListeners=function(d){var m;return d?(m=p?p+d:d,this._events[m]&&$(this,m)):(this._events=new V,this._eventsCount=0),this},k.prototype.off=k.prototype.removeListener,k.prototype.addListener=k.prototype.on,k.prefixed=p,k.EventEmitter=k,H.exports=k},function(H,q,w){w.r(q);var y,p=function(){function n(){this._el=new Float32Array(16),this.identity()}return Object.defineProperty(n.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),n.prototype.identity=function(){return this._el[0]=1,this._el[1]=0,this._el[2]=0,this._el[3]=0,this._el[4]=0,this._el[5]=1,this._el[6]=0,this._el[7]=0,this._el[8]=0,this._el[9]=0,this._el[10]=1,this._el[11]=0,this._el[12]=0,this._el[13]=0,this._el[14]=0,this._el[15]=1,this},n.prototype.multiply=function(e){return this.multiplyMatrices(this,e),this},n.prototype.multiplyMatrices=function(e,t){var r=e.el,i=t.el,o=r[0],c=r[1],h=r[2],_=r[3],u=r[4],a=r[5],l=r[6],s=r[7],f=r[8],b=r[9],g=r[10],x=r[11],j=r[12],A=r[13],R=r[14],M=r[15],T=i[0],P=i[1],F=i[2],B=i[3],C=i[4],N=i[5],D=i[6],I=i[7],E=i[8],S=i[9],ee=i[10],te=i[11],re=i[12],ie=i[13],ne=i[14],oe=i[15];return this._el[0]=T*o+P*u+F*f+B*j,this._el[1]=T*c+P*a+F*b+B*A,this._el[2]=T*h+P*l+F*g+B*R,this._el[3]=T*_+P*s+F*x+B*M,this._el[4]=C*o+N*u+D*f+I*j,this._el[5]=C*c+N*a+D*b+I*A,this._el[6]=C*h+N*l+D*g+I*R,this._el[7]=C*_+N*s+D*x+I*M,this._el[8]=E*o+S*u+ee*f+te*j,this._el[9]=E*c+S*a+ee*b+te*A,this._el[10]=E*h+S*l+ee*g+te*R,this._el[11]=E*_+S*s+ee*x+te*M,this._el[12]=re*o+ie*u+ne*f+oe*j,this._el[13]=re*c+ie*a+ne*b+oe*A,this._el[14]=re*h+ie*l+ne*g+oe*R,this._el[15]=re*_+ie*s+ne*x+oe*M,this},n.prototype.scale=function(e){return this._el[0]=this._el[0]*e[0],this._el[1]=this._el[1]*e[0],this._el[2]=this._el[2]*e[0],this._el[3]=this._el[3]*e[0],this._el[4]=this._el[4]*e[1],this._el[5]=this._el[5]*e[1],this._el[6]=this._el[6]*e[1],this._el[7]=this._el[7]*e[1],this._el[8]=this._el[8]*e[2],this._el[9]=this._el[9]*e[2],this._el[10]=this._el[10]*e[2],this._el[11]=this._el[11]*e[2],this},n.prototype.translate=function(e){return this._el[12]=this._el[0]*e[0]+this._el[4]*e[1]+this._el[8]*e[2]+this._el[12],this._el[13]=this._el[1]*e[0]+this._el[5]*e[1]+this._el[9]*e[2]+this._el[13],this._el[14]=this._el[2]*e[0]+this._el[6]*e[1]+this._el[10]*e[2]+this._el[14],this._el[15]=this._el[3]*e[0]+this._el[7]*e[1]+this._el[11]*e[2]+this._el[15],this},n.prototype.rotate=function(e,t){var r=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);if(r){var i=t[0],o=t[1],c=t[2];r!==1&&(i*=r=1/r,o*=r,c*=r);var h=Math.sin(e),_=Math.cos(e),u=1-_,a=this._el[0],l=this._el[1],s=this._el[2],f=this._el[3],b=this._el[4],g=this._el[5],x=this._el[6],j=this._el[7],A=this._el[8],R=this._el[9],M=this._el[10],T=this._el[11],P=i*i*u+_,F=o*i*u+c*h,B=c*i*u-o*h,C=i*o*u-c*h,N=o*o*u+_,D=c*o*u+i*h,I=i*c*u+o*h,E=o*c*u-i*h,S=c*c*u+_;return this._el[0]=a*P+b*F+A*B,this._el[1]=l*P+g*F+R*B,this._el[2]=s*P+x*F+M*B,this._el[3]=f*P+j*F+T*B,this._el[4]=a*C+b*N+A*D,this._el[5]=l*C+g*N+R*D,this._el[6]=s*C+x*N+M*D,this._el[7]=f*C+j*N+T*D,this._el[8]=a*I+b*E+A*S,this._el[9]=l*I+g*E+R*S,this._el[10]=s*I+x*E+M*S,this._el[11]=f*I+j*E+T*S,this}},n.prototype.lookAt=function(e,t,r){var i,o,c,h,_,u,a,l,s,f,b=e.x,g=e.y,x=e.z,j=r.x,A=r.y,R=r.z,M=t.x,T=t.y,P=t.z;if(b!==M||g!==T||x!==P)return a=b-t.x,l=g-t.y,s=x-t.z,i=A*(s*=f=1/Math.sqrt(a*a+l*l+s*s))-R*(l*=f),o=R*(a*=f)-j*s,c=j*l-A*a,(f=Math.sqrt(i*i+o*o+c*c))?(i*=f=1/f,o*=f,c*=f):(i=0,o=0,c=0),h=l*c-s*o,_=s*i-a*c,u=a*o-l*i,(f=Math.sqrt(h*h+_*_+u*u))?(h*=f=1/f,_*=f,u*=f):(h=0,_=0,u=0),this._el[0]=i,this._el[1]=h,this._el[2]=a,this._el[3]=0,this._el[4]=o,this._el[5]=_,this._el[6]=l,this._el[7]=0,this._el[8]=c,this._el[9]=u,this._el[10]=s,this._el[11]=0,this._el[12]=-(i*b+o*g+c*x),this._el[13]=-(h*b+_*g+u*x),this._el[14]=-(a*b+l*g+s*x),this._el[15]=1,this;this.identity()},n.prototype.perspective=function(e,t,r,i){var o=r*Math.tan(e*Math.PI/360),c=2*(o*t),h=2*o,_=i-r;return this._el[0]=2*r/c,this._el[1]=0,this._el[2]=0,this._el[3]=0,this._el[4]=0,this._el[5]=2*r/h,this._el[6]=0,this._el[7]=0,this._el[8]=0,this._el[9]=0,this._el[10]=-(i+r)/_,this._el[11]=-1,this._el[12]=0,this._el[13]=0,this._el[14]=-i*r*2/_,this._el[15]=0,this},n.prototype.transpose=function(){var e=this._el[0],t=this._el[1],r=this._el[2],i=this._el[3],o=this._el[4],c=this._el[5],h=this._el[6],_=this._el[7],u=this._el[8],a=this._el[9],l=this._el[10],s=this._el[11],f=this._el[12],b=this._el[13],g=this._el[14],x=this._el[15];return this._el[0]=e,this._el[1]=o,this._el[2]=u,this._el[3]=f,this._el[4]=t,this._el[5]=c,this._el[6]=a,this._el[7]=b,this._el[8]=r,this._el[9]=h,this._el[10]=l,this._el[11]=g,this._el[12]=i,this._el[13]=_,this._el[14]=s,this._el[15]=x,this},n.prototype.inverse=function(){var e=this._el[0],t=this._el[1],r=this._el[2],i=this._el[3],o=this._el[4],c=this._el[5],h=this._el[6],_=this._el[7],u=this._el[8],a=this._el[9],l=this._el[10],s=this._el[11],f=this._el[12],b=this._el[13],g=this._el[14],x=this._el[15],j=e*c-t*o,A=e*h-r*o,R=e*_-i*o,M=t*h-r*c,T=t*_-i*c,P=r*_-i*h,F=u*b-a*f,B=u*g-l*f,C=u*x-s*f,N=a*g-l*b,D=a*x-s*b,I=l*x-s*g,E=1/(j*I-A*D+R*N+M*C-T*B+P*F);return this._el[0]=(c*I-h*D+_*N)*E,this._el[1]=(-t*I+r*D-i*N)*E,this._el[2]=(b*P-g*T+x*M)*E,this._el[3]=(-a*P+l*T-s*M)*E,this._el[4]=(-o*I+h*C-_*B)*E,this._el[5]=(e*I-r*C+i*B)*E,this._el[6]=(-f*P+g*R-x*A)*E,this._el[7]=(u*P-l*R+s*A)*E,this._el[8]=(o*D-c*C+_*F)*E,this._el[9]=(-e*D+t*C-i*F)*E,this._el[10]=(f*T-b*R+x*j)*E,this._el[11]=(-u*T+a*R-s*j)*E,this._el[12]=(-o*N+c*B-h*F)*E,this._el[13]=(e*N-t*B+r*F)*E,this._el[14]=(-f*M+b*A-g*j)*E,this._el[15]=(u*M-a*A+l*j)*E,this},n.prototype.clone=function(){var e=new n,t=this._el[0],r=this._el[1],i=this._el[2],o=this._el[3],c=this._el[4],h=this._el[5],_=this._el[6],u=this._el[7],a=this._el[8],l=this._el[9],s=this._el[10],f=this._el[11],b=this._el[12],g=this._el[13],x=this._el[14],j=this._el[15];return e.el[0]=t,e.el[1]=r,e.el[2]=i,e.el[3]=o,e.el[4]=c,e.el[5]=h,e.el[6]=_,e.el[7]=u,e.el[8]=a,e.el[9]=l,e.el[10]=s,e.el[11]=f,e.el[12]=b,e.el[13]=g,e.el[14]=x,e.el[15]=j,e},n.prototype.copy=function(e){return this._el[0]=e.el[0],this._el[1]=e.el[1],this._el[2]=e.el[2],this._el[3]=e.el[3],this._el[4]=e.el[4],this._el[5]=e.el[5],this._el[6]=e.el[6],this._el[7]=e.el[7],this._el[8]=e.el[8],this._el[9]=e.el[9],this._el[10]=e.el[10],this._el[11]=e.el[11],this._el[12]=e.el[12],this._el[13]=e.el[13],this._el[14]=e.el[14],this._el[15]=e.el[15],this},n.prototype.compose=function(e,t,r){var i=t.x,o=t.y,c=t.z,h=t.w,_=i+i,u=o+o,a=c+c,l=i*_,s=i*u,f=i*a,b=o*u,g=o*a,x=c*a,j=h*_,A=h*u,R=h*a,M=r.x,T=r.y,P=r.z;return this._el[0]=(1-(b+x))*M,this._el[1]=(s+R)*M,this._el[2]=(f-A)*M,this._el[3]=0,this._el[4]=(s-R)*T,this._el[5]=(1-(l+x))*T,this._el[6]=(g+j)*T,this._el[7]=0,this._el[8]=(f+A)*P,this._el[9]=(g-j)*P,this._el[10]=(1-(l+b))*P,this._el[11]=0,this._el[12]=e.x,this._el[13]=e.y,this._el[14]=e.z,this._el[15]=1,this},n.prototype.getInverse=function(e){var t=e.el[0],r=e.el[1],i=e.el[2],o=e.el[3],c=e.el[4],h=e.el[5],_=e.el[6],u=e.el[7],a=e.el[8],l=e.el[9],s=e.el[10],f=e.el[11],b=e.el[12],g=e.el[13],x=e.el[14],j=e.el[15],A=t*h-r*c,R=t*_-i*c,M=t*u-o*c,T=r*_-i*h,P=r*u-o*h,F=i*u-o*_,B=a*g-l*b,C=a*x-s*b,N=a*j-f*b,D=l*x-s*g,I=l*j-f*g,E=s*j-f*x,S=1/(A*E-R*I+M*D+T*N-P*C+F*B);return this._el[0]=(h*E-_*I+u*D)*S,this._el[1]=(-r*E+i*I-o*D)*S,this._el[2]=(g*F-x*P+j*T)*S,this._el[3]=(-l*F+s*P-f*T)*S,this._el[4]=(-c*E+_*N-u*C)*S,this._el[5]=(t*E-i*N+o*C)*S,this._el[6]=(-b*F+x*M-j*R)*S,this._el[7]=(a*F-s*M+f*R)*S,this._el[8]=(c*I-h*N+u*B)*S,this._el[9]=(-t*I+r*N-o*B)*S,this._el[10]=(b*P-g*M+j*A)*S,this._el[11]=(-a*P+l*M-f*A)*S,this._el[12]=(-c*D+h*C-_*B)*S,this._el[13]=(t*D-r*C+i*B)*S,this._el[14]=(-b*T+g*R-x*A)*S,this._el[15]=(a*T-l*R+s*A)*S,this},n}(),V=w(0),Z=w.n(V);(function(n){n.FRONT="SIDE_FRONT",n.BACK="SIDE_BACK",n.DOUBLE="SIDE_DOUBLE"})(y||(y={}));var Q,$,k=function(n,e){return e===void 0&&(e={}),n.getContext("webgl",e)||n.getContext("experimental-webgl",e)},d=function(n,e,t){var r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("could not compile shader:"+n.getShaderInfoLog(r));return r},m=function(n,e){var t=function(r,i){var o=r.createBuffer();return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,o),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Int16Array(i),r.STATIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),o}(n,e);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),n.drawElements(n.TRIANGLES,e.length,n.UNSIGNED_SHORT,0)},v=function(n){return n===void 0&&(n=1e3),new Date().getTime().toString(16)+Math.floor(n*Math.random()).toString(16)},G=(Q=function(n,e){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])})(n,e)},function(n,e){function t(){this.constructor=n}Q(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}),W=function(n){function e(t,r,i){t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var o=n.call(this)||this;return o._x=0,o._y=0,o._z=0,o._x=t,o._y=r,o._z=i,o}return G(e,n),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this.emit("change")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this.emit("change")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this.emit("change")},enumerable:!0,configurable:!0}),e}(Z.a),U=function(){function n(e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this._x=0,this._y=0,this._z=0,this._w=0,this._x=e,this._y=t,this._z=r,this._w=i}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this._z},set:function(e){this._z=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"w",{get:function(){return this._w},set:function(e){this._w=e},enumerable:!0,configurable:!0}),n.prototype.setFromEuler=function(e){var t=e.x,r=e.y,i=e.z,o=Math.cos,c=Math.sin,h=o(t/2),_=o(r/2),u=o(i/2),a=c(t/2),l=c(r/2),s=c(i/2);return this._x=a*_*u+h*l*s,this._y=h*l*u-a*_*s,this._z=h*_*s+a*l*u,this._w=h*_*u-a*l*s,this},n}(),Y=function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),z=function(n){function e(){var t=n.call(this)||this;return t._id=v(),t._position=new W,t._up=new W(0,1,0),t._scale=new W(1,1,1),t._rotation=new W,t._quaternion=new U,t._parent=null,t._children=[],t._matrix=new p,t._matrixWorld=new p,t._modelViewMatrix=new p,t._matrixWorldNeedsUpdate=!1,t._onChangeRotation=function(){t._quaternion.setFromEuler(t._rotation)},t.rotation.on("change",t._onChangeRotation),t}return Y(e,n),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return this._up},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quaternion",{get:function(){return this._quaternion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this._matrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrixWorld",{get:function(){return this._matrixWorld},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modelViewMatrix",{get:function(){return this._modelViewMatrix},enumerable:!0,configurable:!0}),e.prototype.add=function(t){this._children.push(t),t.parent=this},e.prototype.updateMatrix=function(){this._matrix.compose(this._position,this._quaternion,this._scale),this._matrixWorldNeedsUpdate=!0},e.prototype.updateMatrixWorld=function(){this.updateMatrix(),this._matrixWorldNeedsUpdate&&(this._parent?this._matrixWorld.multiplyMatrices(this._parent.matrixWorld,this._matrix):this._matrixWorld.copy(this.matrix),this._matrixWorldNeedsUpdate=!1);for(var t=this._children,r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld()},e}(Z.a),L=function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),O=function(n){function e(t,r){var i=n.call(this)||this;return i._geometry=t,i._material=r,i}return L(e,n),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},enumerable:!0,configurable:!0}),e}(z),J=function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),K=function(n){function e(t,r){var i=n.call(this)||this;return i._geometry=t,i._material=r,i}return J(e,n),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},enumerable:!0,configurable:!0}),e}(z),le=function(){function n(e){e===void 0&&(e={}),this._renderList=[],this._pMatrix=new p,this._textures=[],this._width=400,this._height=300,this._pixelRatio=2,this._domElement=document.createElement("canvas"),this._clearColor=[0,0,0,1],this._gl=k(this._domElement,e),this.setSize(this._width,this._height)}return Object.defineProperty(n.prototype,"pixelRatio",{get:function(){return this._pixelRatio},set:function(e){this._pixelRatio=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"domElement",{get:function(){return this._domElement},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clearColor",{set:function(e){this._clearColor=e},enumerable:!0,configurable:!0}),n.prototype.setSize=function(e,t){var r=e*this._pixelRatio,i=t*this._pixelRatio;this._width=e,this._height=t,this._domElement.style.width=this._width+"px",this._domElement.style.height=this._height+"px",this._domElement.width=r,this._domElement.height=i,this._gl.viewport(0,0,r,i),this._pMatrix.perspective(90,r/i,.1,100)},n.prototype.render=function(e,t){var r,i,o,c=this;r=this._gl,(i=this._clearColor)===void 0&&(i=[0,0,0,1]),o===void 0&&(o=1),r.clearColor(i[0],i[1],i[2],i[3]),r.clearDepth(o),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),e.updateMatrixWorld(),t.updateMatrixWorld(),e.needsUpdate&&(this._renderList=[],this._projectObject(e),e.needsUpdate=!1),this._renderList.forEach(function(h){c._renderObj(h,t)}),this._gl.flush()},n.prototype._projectObject=function(e){var t=this;if(e instanceof O||e instanceof K){var r=function(h,_,u){var a=d(h,_,h.VERTEX_SHADER),l=d(h,u,h.FRAGMENT_SHADER),s=h.createProgram();if(h.attachShader(s,a),h.attachShader(s,l),h.linkProgram(s),!h.getProgramParameter(s,h.LINK_STATUS))throw new Error("program filed to link:"+h.getProgramInfoLog(s));return h.useProgram(s),s}(this._gl,e.material.vertexShader,e.material.fragmentShader),i={};Object.keys(e.geometry.attributes).forEach(function(h){var _,u,a,l=e.geometry.attributes[h],s={vbo:(_=t._gl,u=l.verticies,a=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,a),_.bufferData(_.ARRAY_BUFFER,new Float32Array(u),_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,null),a),attrLoc:t._gl.getAttribLocation(r,h),stride:l.stride};i[h]=s});var o={};Object.keys(e.material.uniforms).forEach(function(h){var _=e.material.uniforms[h];if(o[h]=t._gl.getUniformLocation(r,h),_.type==="t"){var u=t._gl.TEXTURE0,a=_.value,l=function(s,f,b){var g=s.createTexture();return s.activeTexture(b),s.bindTexture(s.TEXTURE_2D,g),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,f),s.generateMipmap(s.TEXTURE_2D),s.bindTexture(s.TEXTURE_2D,null),g}(t._gl,a,u);t._textures.push({slot:u,image:a,webglTexture:l})}});var c={obj:e,program:r,attributes:i,uniforms:o};this._renderList.push(c)}e.children.forEach(function(h){t._projectObject(h)})},n.prototype._renderObj=function(e,t){var r,i=this,o=e.obj,c=e.program,h=e.attributes,_=e.uniforms,u=o.geometry,a=o.material;o.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,o.matrixWorld),Object.keys(h).forEach(function(l){var s=h[l];i._gl.bindBuffer(i._gl.ARRAY_BUFFER,s.vbo),i._gl.enableVertexAttribArray(s.attrLoc),i._gl.vertexAttribPointer(s.attrLoc,s.stride,i._gl.FLOAT,!1,0,0),i._gl.bindBuffer(i._gl.ARRAY_BUFFER,null)}),this._gl.useProgram(c),a.uniforms.mMatrix.value=o.matrix,a.uniforms.vMatrix.value=t.matrixWorldInverse,a.uniforms.pMatrix.value=this._pMatrix,a.uniforms.mvMatrix.value=o.modelViewMatrix,Object.keys(_).forEach(function(l){var s=_[l],f=a.uniforms[l];switch(f.type){case"v4":i._gl.uniformMatrix4fv(s,!1,f.value.el);break;case"f":i._gl.uniform1f(s,f.value);break;case"t":var b=i._textures.find(function(g){return g.image.src===f.value.src});b&&(i._gl.activeTexture(i._gl.TEXTURE0),i._gl.bindTexture(i._gl.TEXTURE_2D,b.webglTexture),i._gl.uniform1i(s,0))}}),(r=this._gl).enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),function(l,s){s?(l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA)):l.disable(l.BLEND)}(this._gl,a.transparent),function(l,s){switch(s){case y.DOUBLE:l.disable(l.CULL_FACE);break;case y.BACK:l.enable(l.CULL_FACE),l.frontFace(l.CW);break;case y.FRONT:default:l.enable(l.CULL_FACE),l.frontFace(l.CCW)}}(this._gl,a.side),o instanceof O?m(this._gl,u.index):o instanceof K&&function(l,s){l.drawArrays(l.POINTS,0,s.length/3)}(this._gl,u.attributes.position.verticies)},n}(),ue=function(){function n(){this._attributes={},this._index=[]}return Object.defineProperty(n.prototype,"attributes",{get:function(){return this._attributes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"index",{get:function(){return this._index},set:function(e){this._index=e},enumerable:!0,configurable:!0}),n.prototype.addAttribute=function(e,t,r){this._attributes[e]={stride:t,verticies:r}},n}(),he=function(){return(he=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}).apply(this,arguments)};(function(n){n.NO="BLENDING_NO"})($||($={}));var ce=function(){function n(e){this._uniforms={mMatrix:{type:"v4",value:new p},vMatrix:{type:"v4",value:new p},pMatrix:{type:"v4",value:new p},mvMatrix:{type:"v4",value:new p}},this._transparent=!1,this._side=y.FRONT,this._blending=$.NO,this._uniforms=he({},this._uniforms,e.uniforms),this._vertexShader=e.vertexShader,this._fragmentShader=e.fragmentShader,this._transparent=e.transparent||!1,this._side=e.side||this._side,this._blending=e.blending||"BLENDING_NO"}return Object.defineProperty(n.prototype,"uniforms",{get:function(){return this._uniforms},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"vertexShader",{get:function(){return this._vertexShader},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fragmentShader",{get:function(){return this._fragmentShader},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"transparent",{get:function(){return this._transparent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"side",{get:function(){return this._side},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blending",{get:function(){return this._blending},enumerable:!0,configurable:!0}),n}(),fe=function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),pe=function(n){function e(){var t=n.call(this)||this;return t._needsUpdate=!0,t}return fe(e,n),Object.defineProperty(e.prototype,"needsUpdate",{get:function(){return this._needsUpdate},set:function(t){this._needsUpdate=t},enumerable:!0,configurable:!0}),e}(z),de=function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ye=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._matrixWorldInverse=new p,t}return de(e,n),Object.defineProperty(e.prototype,"matrixWorldInverse",{get:function(){return this._matrixWorldInverse},enumerable:!0,configurable:!0}),e.prototype.updateMatrixWorld=function(){n.prototype.updateMatrixWorld.call(this),this.matrixWorldInverse.getInverse(this.matrixWorld)},e}(z);q.default={Renderer:le,Matrix4:p,Object3D:z,Geometry:ue,Material:ce,Mesh:O,Points:K,Scene:pe,Vector3:W,Quaternion:U,Camera:ye}}]).default})})(_e);var ae=_e.exports;const me=ge(ae),ve=be({__proto__:null,default:me},[ae]);export{ve as s};
